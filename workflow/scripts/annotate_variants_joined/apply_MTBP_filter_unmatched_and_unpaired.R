# A script to filter variants from the unmatched and unpaired analysis

library(magrittr)

input = readr::read_tsv(snakemake@input[[1]])
print(input)

MTBP_records = tibble::tribble(
	~CHROM, ~POS, ~REF, ~ALT,
	'chr17',	41244318,	'CCT',	'C',
	'chr17',	41243479,	'CTTGA',	'C',
	'chr17',	41215920,	'G',	'T',
	'chr17',	41197771,	'A',	'G',
	'chr17',	41203122,	'GC',	'G',
	'chr17',	41209139,	'A',	'G',
	'chr17',	41222994,	'AC',	'A',
	'chr17',	41234592,	'G',	'A',
	'chr17',	41223056,	'A',	'C',
	'chr17',	41223063,	'G',	'C',
	'chr17',	41226499,	'C',	'T',
	'chr17',	41226515,	'G',	'T',
	'chr17',	41228595,	'AT',	'A',
	'chr17',	41244218,	'CT',	'C',
	'chr17',	41243788,	'TAGAC',	'T',
	'chr17',	41243941,	'G',	'A',
	'chr17',	41245586,	'CT',	'C',
	'chr17',	41244214,	'CT',	'C',
	'chr17',	41244528,	'G',	'T',
	'chr17',	41244542,	'GT',	'G,*',
	'chr17',	41244865,	'GTT',	'G',
	'chr17',	41245072,	'TG',	'T',
	'chr17',	41245354,	'C',	'A',
	'chr17',	41245473,	'TG',	'T',
	'chr17',	41245586,	'CT',	'C,*',
	'chr17',	41246039,	'CTTTAA',	'C',
	'chr17',	41246531,	'CT',	'C',
	'chr17',	41246531,	'CT',	'C,*',
	'chr17',	41276044,	'ACT',	'A',
	'chr17',	41276044,	'ACT',	'A',
	'chr17',	41226373,	'TGTTTCCGTCAAATC',	'T',
	'chr17',	41226504,	'TA',	'T',
	'chr17',	41226540,	'T',	'C',
	'chr17',	41246839,	'C',	'A',
	'chr17',	41247864,	'CT',	'C',
	'chr17',	41256216,	'CTTCATCTTTTAGATGTTCAGGAGAGTTAT',	'C',
	'chr17',	41256280,	'T',	'C',
	'chr13',	32912964,	'TGAAA',	'T',
	'chr13',	32912895,	'CTGACA',	'C',
	'chr13',	32912655,	'CT',	'C',
	'chr13',	32913295,	'TA',	'T',
	'chr13',	32912345,	'GA',	'G',
	'chr13',	32911442,	'GA',	'G',
	'chr13',	32907420,	'GA',	'G',
	'chr13',	32906602,	'GA',	'G',
	'chr13',	32906565,	'CA',	'C',
	'chr13',	32903604,	'CTG',	'C',
	'chr13',	32913381,	'CA',	'C',
	'chr13',	32914616,	'CA',	'C',
	'chr13',	32954022,	'CA',	'C',
	'chr13',	32953632,	'CA',	'C',
	'chr13',	32944692,	'C',	'T',
	'chr13',	32937647,	'GC',	'G',
	'chr13',	32937635,	'AC',	'A',
	'chr13',	32937634,	'T',	'A',
	'chr13',	32937479,	'CA',	'C',
	'chr13',	32937354,	'TA',	'T',
	'chr13',	32915061,	'TA',	'T',
	'chr13',	32915053,	'TA',	'T',
	'chr13',	32914939,	'T',	'TA',
	'chr13',	32914766,	'CTT',	'C',
	'chr13',	32914577,	'G',	'T',
	'chr13',	32913391,	'CT',	'C',
	'chr13',	32914250,	'GT',	'G',
	'chr13',	32914209,	'ACTCT',	'A',
	'chr13',	32913836,	'CAA',	'C',
	'chr13',	32913836,	'CA',	'C',
	'chr13',	32913558,	'CA',	'C,TA',
	'chr13',	32913558,	'CA',	'C',
	'chr13',	32913558,	'C',	'CA',
	'chr13',	32899300,	'TA',	'T',
	'chr13',	32912738,	'CA',	'C',
	'chr13',	32912000,	'GC',	'G',
	'chr13',	32911928,	'GA',	'G',
	'chr13',	32906662,	'AG',	'A,*',
	'chr13',	32900668,	'TCTAGGAGCTGAGGTGGATC',	'T',
	'chr13',	32890649,	'CG',	'C,*',
	'chr13',	32890649,	'CG',	'C',
	'chr13',	32914137,	'CA',	'C',
	'chr13',	32913783,	'CA',	'C',
	'chr13',	32913556,	'AGC',	'A',
	'chr13',	32913550,	'ACTTG',	'A',
	'chr13',	32913549,	'T',	'TAAAAA',
	'chr17',	59861748,	'AT',	'A',
	'chr17',	59761413,	'CTTTG',	'C',
	'chr17',	59886120,	'T',	'C',
	'chr17',	59926488,	'A',	'G',
	'chr17',	59885981,	'CTGCT',	'C',
	'chr17',	59858291,	'AT',	'A',
	'chr17',	59761411,	'CTCTT',	'C',
	'chr7',	55242490,	'A',	'G',
	'chr12',	25398209,	 'T',	'C',
	'chr12',	25398230,	'T',	'C',
	'chr12',	25398284,	'C',	'A',
	'chr12',	25398284,	'C',	'T',
	'chr17',	37619004,	'G',	'A',
	'chr17',	37673691,	'A',	'G',
	'chr17',	37646921,	'TC',	'T',
	'chr17',	37627670,	'C',	'CT,TT',
	'chr17',	37627304,	'GC',	'G',
	'chr17',	37619281,	'C',	'A',
	'chr17',	37619279,	'T',	'TA',
	'chr17',	37619026,	'T',	'TGA',
	'chr17',	29422382,	'G',	'T',
	'chr17',	29548884,	'A',	'G',
	'chr17',	29550472,	'CT',	'C',
	'chr17',	29553477,	'A',	'AC',
	'chr17',	29556462,	'GT',	'G',
	'chr17',	29587421,	'A',	'G',
	'chr17',	29553477,	'AC',	'A',
	'chr17',	29664534,	'TGA',	'T',
	'chr17',	29664534,	'TGA',	'T,*',
	'chr17',	29677227,	'C',	'T',
	'chr17',	29541472,	'CT',	'C',
	'chr17',	29528427,	'AGATCTGCCTGGCTCAG',	'A',
	'chr17',	29527440,	'A',	'T',
	'chr17',	29509646,	'TATCCAAAGACGTGGTTGATGAAAACAAC',	'T',
	'chr17',	29509524,	'A',	'G',
	'chr17',	29508502,	'GA',	'G',
	'chr17',	29483098,	'T',	'A',
	'chr17',	29552143,	'CT',	'C',
	'chr17',	29554252,	'GA',	'G',
	'chr17',	29556352,	'G',	'T',
	'chr17',	29562788,	'A',	'T',
	'chr17',	29587535,	'T',	'G',
	'chr17',	29653061,	'AG',	'A',
	'chr17',	29654788,	'CA',	'C',
	'chr17',	29663350,	'G',	'A',
	'chr17',	29676271,	'T',	'C',
	'chr17',	29677329,	'TC',	'T',
	'chr17',	29684376,	'C',	'CT',
	'chr17',	29685607,	'TC',	'T',
	'chr17',	29701029,	'A',	'G',
	'chr1',	115256529,	'T',	'C',
	'chr1',	115258747,	'C',	'A',
	'chr16',	23646552,	'CT',	'C',
	'chr16',	23625409,	'AT',	'A',
	'chr16',	23646980,	'AT',	'A',
	'chr16',	23647120,	'AG',	'A',
	'chr16',	23641509,	'G',	'GAAAAAAAA',
	'chr16',	23641509,	'G',	'AAAAAAAAA',
	'chr16',	23632801,	'T',	'C',
	'chr3',	178952061,	'T',	'C',
	'chr3',	178936094,	'C',	'G',
	'chr3',	178952090,	'G',	'C',
	'chr3',	178952136,	'A',	'G',
	'chr3',	178952148,	'A',	'G',
	'chr3',	178936083,	'A',	'G',
	'chr10',	89692898,	'A',	'G',
	'chr10',	89717769,	'TA',	'T',
	'chr10',	89692887,	'G',	'C',
	'chr10',	89624297,	'A',	'T',
	'chr10',	89725045,	'T',	'C',
	'chr14',	68292235,	'C',	'T',
	'chr14',	68292196,	'T',	'TC',
	'chr17',	33428320,	'C',	'T',
	'chr17',	33434024,	'G',	'A',
	'chr13',	48881488,	'CAG',	'C',
	'chr13',	48937023,	'CAAAACAACTAGAA',	'C',
	'chr13',	49030478,	'TA',	'T',
	'chr13',	48951105,	'G',	'T',
	'chr13',	48955534,	'AGAACGATGTGAACATC',	'A',
	'chr13',	49051490,	'G',	'GT',
	'chr13',	49033910,	'CT',	'C',
	'chr13',	49030367,	'GA',	'G',
	'chr13',	49027203,	'T',	'A',
	'chr13',	49033824,	'T',	'C',
	'chr2',	215646084,	'CT',	'C'	
)

print(MTBP_records)

filtered_input = dplyr::semi_join(
		input,
		MTBP_records,
		by=c('CHROM','POS','REF','ALT')
	)

print(filtered_input)

filtered_input %>% dplyr::group_by(CHROM,POS,REF,ALT) %>% dplyr::summarise(n=dplyr::n()) %>% dplyr::arrange(-n) %>% print(n=30)
#quit()
#filtered_input %>% dplyr::select(CHROM,POS,REF,ALT) %>% unique() %>% print()

readr::write_tsv(filtered_input, snakemake@output[[1]], col_names=TRUE)
